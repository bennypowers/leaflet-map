<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>leaflet-map web-component demo</title>
	<script src="https://unpkg.com/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
	<script src="https://unpkg.com/leaflet"></script>
	<script type="module" src="https://unpkg.com/api-viewer-element?module"></script>
	<script type="module" src="index.js"></script>

	<style type="text/css">
		body {
			height: 100%;
			margin: 0;
			font-family: sans-serif;
			background-color: #DDD;
		}

		header {
			max-width: 790px;
			background-color: #FFF;
			padding: 1em;
			margin: 1em auto;
			box-shadow: 0 0 50px rgba(0, 0, 0, 0.2);
		}

		.navbar {
			background-color: #EEE;
			border-radius: 5px
		}

		.menubutton {
			display: inline-block;
			padding: 1em 2em;
			color: #000;
			border-right: 1px solid #AAA;
			text-decoration: none;
		    text-shadow: 1px 1px 0 #FFF;
		}

		.githubbutton {
			border-left: 1px solid #AAA;
		}

		#content,
		.announcement {
			max-width: 790px;
			background-color: #FFF;
			padding: 1em;
			margin: 0 auto;
			box-shadow: 0 0 50px rgba(0, 0, 0, 0.2);
		}

		.announcement {
			margin: 1em auto;
			border: 2px solid #0A0;
		}

		h2 {
			font-size: 1.8em;
			margin: 1.5em 0 0.5em -2px;
			font-weight: bold;
			padding: .2em .5em;
			background: #edeeef;
			border-right: 1px solid #ccc;
			border-bottom: 1px solid #ccc;
			color: #fff;
			background-color: #b0de5c;
			background-image: -moz-linear-gradient(top, #b0de5c, #82cb00);
			background-image: -o-linear-gradient(top, #b0de5c, #82cb00);
			background-image: -webkit-gradient(linear, left top, left bottom, from(#b0de5c), to(#82cb00));
			background-image: -webkit-linear-gradient(top, #b0de5c, #82cb00);
			background-image: linear-gradient(top, #b0de5c, #82cb00);
			filter: progid:DXImageTransform.Microsoft.gradient(startColorStr='#b0de5c', EndColorStr='#82cb00');
			border-radius: 5px;
			text-shadow: 0 -1px 1px rgba(0, 0, 0, 0.35);
			box-shadow: 2px 2px 3px rgba(0, 0, 0, 0.2);
		}

		.nav {
			color: #000;
			text-decoration: none;
			border-bottom: 1px dashed #000;
			display: inline-block;
			padding: 3px;
		}

		.nav:hover {
			background-color: #DDF;
		}

		leaflet-map,
		geolocation-sample {
			max-width: 20em;
			height: 20em;
			border: 1px solid #aaa;
		}

		geolocation-sample {
			height: 21em;
		}

		pre {
			font-size: large;
			padding: 0.5em 1em;
			background-color: #DDD;
			clear: all;
		}
	</style>
</head>

<body>
		<header>
			<h1>&lt;leaflet-map&gt;</h1>
			<p>Leaflet map as web component.</p>

			<div class="navbar">
				<a class="menubutton demobutton" href="https://leaflet-extras.github.io/leaflet-map/demo.html">Demo</a>
				<a class="menubutton apidocbutton"
					href="https://leaflet-extras.github.io/leaflet-map/doc.html#leaflet-map">API</a>
				<a class="menubutton pluginbutton" href="https://leaflet-extras.github.io/leaflet-map/plugins.html">Plugins</a>
				<a class="menubutton downloadbutton"
					href="https://github.com/leaflet-extras/leaflet-map/releases/download/v1.2.0/leaflet-map-1.2.0.zip">Download</a>
				<a class="menubutton githubbutton" href="https://github.com/leaflet-extras/leaflet-map/">Github</a>
			</div>
		</header>
	<main>
		<div id="content">

			<p>Most of the options documented in the <a href="http://leafletjs.com/reference.html">Leaflet reference</a> are
				exported as html attributes. All events are mapped into html events of the same name.</p>


			<h2 id="simple">Simple</h2>

			<p>Creating a leaflet based map is as simple as adding a <code>&lt;leaflet-map&gt;</code>tag after two lines of boilerplate
				code to load the web component platform and import the leaflet-map component.</p>

			<zero-md src="boilerplate.md"></zero-md>

			<h2 id="view">Initial View</h2>

			<p>Like normal html elements, the map is configurable with attributes. Those attributes correspond to the option
				parameter of L.map as defined in the <a href="http://leafletjs.com/reference.html">leaflet documentation</a>.
				For example the initial view is defined as follows:</p>

			<api-viewer src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map latitude="51.505" longitude="-0.09" zoom="13"> </leaflet-map>
				</template>
			</api-viewer>

			<h2 id="marker">Marker</h2>

			<p>Markers can be defined using html tags as well. The following examples creates a semi transparent marker on the
				left hand side. And a second marker with a popup on click.</p>


			<api-viewer src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="slot">
					<leaflet-marker latitude="51.5" longitude="-0.10" title="Transparent" opacity="0.6"></leaflet-marker>
					<leaflet-marker latitude="51.5" longitude="-0.09" title="Popup Demo">
						<b>Bold</b>
						<p>Text</p>
					</leaflet-marker>
				</template>
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map fit-to-markers></leaflet-map>
				</template>
			</api-viewer>


			<h2 id="icon">Marker with custom icons</h2>

			<p>Markers are based on formating templates called "icons". There are three ways to reference such an icon
				definition:</p>

			<api-viewer src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map latitude="51.505" longitude="-0.09" zoom="13"></leaflet-map>
				</template>
				<template data-element="leaflet-map" data-target="slot">						<leaflet-icon id="myicon" icon-url="https://stendhalgame.org/images/mapmarker/me.png"></leaflet-icon>
					<leaflet-marker latitude="51.5" longitude="-0.10" title="Icon element reference" icon="myicon"></leaflet-marker>
					<leaflet-marker latitude="51.5" longitude="-0.09" title="Icon json" icon='{"iconUrl": "https://stendhalgame.org/images/mapmarker/dungeon.png"}'></leaflet-marker>
					<leaflet-marker id="icon-reference" latitude="51.5" longitude="-0.08" title="Icon L.icon()"></leaflet-marker>
				</template>
			</api-viewer>

			<p>The template icon may be defined using <code>&lt;leaflet-icon&gt;</code> elements. This is the prefered way. Please note
				that iconSize is mapped to the attributes iconWidth and iconHeight. iconAnchor is mapped to iconAnchorX and
				iconAnchorY and so on:</p>

			<api-viewer src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map latitude="51.5" longitude="-0.10" zoom="8"></leaflet-map>
				</template>
				<template data-element="leaflet-map" data-target="slot">
					<leaflet-icon id="myicon" icon-url="https://stendhalgame.org/images/mapmarker/me.png"></leaflet-icon>
					<leaflet-marker latitude="51.5" longitude="-0.10" title="Element" icon="myicon"></leaflet-marker>
				</template>
			</api-viewer>

			<p>Alternatively plain json is understood, too:</p>

			<api-viewer src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map latitude="51.5" longitude="-0.09" zoom="8"></leaflet-map>
				</template>
				<template data-element="leaflet-map" data-target="slot">
					<leaflet-marker
							latitude="51.5"
							longitude="-0.09"
							title="Icon json"
							icon='{"iconUrl": "https://stendhalgame.org/images/mapmarker/dungeon.png"}'
					></leaflet-marker>
				</template>
			</api-viewer>

			<p>Last but not least, an instance of L.icon may be assigned:</p>

			<api-viewer id="icon-ref" src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map latitude="51.5" longitude="-0.8" zoom="8"></leaflet-map>
				</template>
				<template data-element="leaflet-map" data-target="slot">
					<leaflet-marker latitude="51.5" longitude="-0.8" title="L.icon()"></leaflet-marker>
					<script>
						const marker = document.getElementById('icon-ref').shadowRoot.querySelector('leaflet-marker')
						marker.icon = L.icon({
								"iconUrl": "https://stendhalgame.org/images/mapmarker/npc.png",
								"iconSize": L.point(26, 25),
								"iconAnchor": L.point(0, 0)
						});
					</script>
				</template>
			</api-viewer>

			<h2 id="vector">Circles, polyline and polygons</h2>

			<p>Circles, polylines and polygons can be drawn on the map.</p>

			<api-viewer src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map longitude="77.6" latitude="12.95" zoom="12"></leaflet-map>
				</template>

				<template data-element="leaflet-map" data-target="slot">
					<leaflet-polygon color="#f00" fill-opacity="1" stroke>
						<leaflet-point longitude="77.5700" latitude="12.9700"></leaflet-point>
						<leaflet-point longitude="77.6034" latitude="13.0001"></leaflet-point>
						<leaflet-point longitude="77.6006" latitude="12.9547"></leaflet-point>
						Hi, I am a <b>polygon</b>.
					</leaflet-polygon>

					<leaflet-circle
							longitude="77.58"
							latitude="12.9300"
							radius="2000"
							color="#0a0"
							fill-color="#aa0"
							fill-opacity="0.5"
							fill="true">
						Hi, I am a <b>circle</b>.
					</leaflet-circle>

					<leaflet-polyline
							fill-opacity="0.5"
							stroke>
						<leaflet-point longitude="77.6400" latitude="12.9100"></leaflet-point>
						<leaflet-point longitude="77.6229" latitude="12.9259"></leaflet-point>
						<leaflet-point longitude="77.6499" latitude="12.9699"></leaflet-point>
						<leaflet-point longitude="77.6119" latitude="12.9738"></leaflet-point>
					</leaflet-polyline>

					<leaflet-circle
							longitude="77.64"
							latitude="12.9300"
							radius="500"
							color="#077"
							fill
							fill-opacity="0.5"
					></leaflet-circle>
				</template>
			</api-viewer>

			<h2 id="tilelayer">Tile layer</h2>

			<p>Custom tile layers, for example from online games can be defined using the leaflet-tilelayer element. If there
				is no explicit tilelayer defined, a default one will be used as shown in previous examples.</p>

			<api-viewer src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map latitude="78.8" longitude="-96" zoom="5" min-zoom="2" max-zoom="6"></leaflet-map>
				</template>
				<template data-element="leaflet-map" data-target="slot">
					<leaflet-tilelayer url="https://stendhalgame.org/map/3/{z}-{x}-{y}.png" min-zoom="2" max-zoom="6" no-wrap>
						Map source: <a href="https://stendhalgame.org">Stendhal MMORPG</a>
					</leaflet-tilelayer>
				</template>
			</api-viewer>

			<api-viewer src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map latitude="78.8" longitude="-96" zoom="5" max-zoom="6"></leaflet-map>
				</template>
				<template data-element="leaflet-map" data-target="slot">
					<leaflet-tilelayer url="https://stendhalgame.org/map/3/{z}-{x}-{y}.png" min-zoom="2" max-zoom="6" noWrap>
						Map source: <a href="https://stendhalgame.org">Stendhal MMORPG</a>
					</leaflet-tilelayer>
				</template>
			</api-viewer>

			<h2 id="layerwms">Tile layer WMS</h2>

			<p>It is possible to display data from external WMS services as tile layers on the map.</p>

			<api-viewer src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map latitude="40" longitude="-85" zoom="4"></leaflet-map>
				</template>
				<template data-element="leaflet-map" data-target="slot">
					<leaflet-tilelayer url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png" max-zoom="18">
						Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors,
						<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>,
						Imagery &copy; <a href="http://mapbox.com">Mapbox</a>
					</leaflet-tilelayer>
					<leaflet-tilelayer-wms url="https://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi"
						layers="nexrad-n0r-900913" format="image/png" transparent opacity="0.5">
						Weather data &copy; 2012 IEM Nexrad
					</leaflet-tilelayer-wms>
				</template>
			</api-viewer>

			<api-viewer src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map latitude="40" longitude="-85" zoom="4"></leaflet-map>
				</template>
				<template data-element="leaflet-map" data-target="slot">
					<leaflet-tilelayer
							url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png" max-zoom="19">
								Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a>contr.,
								<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>,
								Imagery &copy; <a href="http://mapbox.com">Mapbox</a>
					</leaflet-tilelayer>
					<leaflet-tilelayer-wms
							url="https://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi"
							layers="nexrad-n0r-900913" format="image/png" transparent opacity="0.5">
									Weather data &copy; 2012 IEM Nexrad
					</leaflet-tilelayer-wms>
				</template>
			</api-viewer>

			<h2 id="event">Events</h2>

			<p>Leaflet events are converted into html events which originate from the component.</p>


			<api-viewer id="eventmap" src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map latitude="51.505" longitude="-0.091" zoom="8"> </leaflet-map>
					<script>
						const map = document.getElementById("eventmap").shadowRoot.querySelector('leaflet-map');
						map.addEventListener("moveend", function (e) {
							const text = "Center: " + this.latitude.toFixed(3) + ", "
								+ this.longitude.toFixed(3);
							map.textContent = text;
						});
					</script>
				</template>
			</api-viewer>

			<h2 id="scale">Scale control</h2>

			<p>A scale control can be added and configured using <leaflet-scale-control>. By default it displays both
				metric and imperial units.</p>

			<api-viewer src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map latitude="51.505" longitude="-0.09" zoom="6"></leaflet-map>
				</template>
				<template data-element="leaflet-map" data-target="slot">
					<leaflet-scale-control position="topright" metric imperial></leaflet-scale-control>
				</template>
			</api-viewer>

			<api-viewer src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map latitude="51.505" longitude="-0.09" zoom="13"></leaflet-map>
				</template>
				<template data-element="leaflet-map" data-target="slot">
					<leaflet-scale-control position="topright" metric imperial></leaflet-scale-control>
				</template>
			</api-viewer>

			<h2 id="geojson">GeoJSON</h2>

			<p>Example of a GeoJSON layer, which is filled by an ajax request.</p>

			<api-viewer id="leafletgeojson" src="custom-elements.json" section="demo" exclude-knobs="children,map" selected="leaflet-map">
				<template data-element="leaflet-map" data-target="host">
					<leaflet-map longitude="102.304" latitude="0.3516" zoom="6"></leaflet-map>
				</template>
				<template data-element="leaflet-map" data-target="slot">
					<leaflet-tilelayer url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png" maxZoom="18">
						Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors,
						<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>,
						Imagery &copy; <a href="http://mapbox.com">Mapbox</a>
					</leaflet-tilelayer>
					<leaflet-geojson color="#FF0000"></leaflet-geojson>
					<script type="module">
						const handleAsJson = r => r.json()
						fetch('demo-geojson.json')
							.then(handleAsJson)
							.then(data => {
								document.getElementById('leafletgeojson')
									.shadowRoot.querySelector('leaflet-geojson')
									.data = data
							})
					</script>
				</template>
			</api-viewer>
		</main>
	</body>
</html>